// Generated by purs version 0.11.5
"use strict";
var Control_Category = require("../Control.Category");
var Control_Semigroupoid = require("../Control.Semigroupoid");
var Data_CatList = require("../Data.CatList");
var Data_Foldable = require("../Data.Foldable");
var Data_Function = require("../Data.Function");
var Data_Functor = require("../Data.Functor");
var Data_Maybe = require("../Data.Maybe");
var Data_Monoid = require("../Data.Monoid");
var Data_Ord = require("../Data.Ord");
var Data_Semigroup = require("../Data.Semigroup");
var Data_StrMap = require("../Data.StrMap");
var Data_String = require("../Data.String");
var Data_Tuple = require("../Data.Tuple");
var Data_Tuple_Nested = require("../Data.Tuple.Nested");
var Prelude = require("../Prelude");
var Text_Smolder_Markup = require("../Text.Smolder.Markup");
var escapeMap = Data_StrMap.fromFoldable(Data_Foldable.foldableArray)([ new Data_Tuple.Tuple("&", "&amp;"), new Data_Tuple.Tuple("<", "&lt;"), new Data_Tuple.Tuple(">", "&gt;"), new Data_Tuple.Tuple("\"", "&quot;"), new Data_Tuple.Tuple("'", "&#39;"), new Data_Tuple.Tuple("/", "&#x2F;") ]);
var escapeChar = function (s) {
    return Data_Maybe.maybe(s)(Control_Category.id(Control_Category.categoryFn))(Data_StrMap.lookup(s)(escapeMap));
};
var $$escape = function (s) {
    return Data_String.joinWith("")(Data_Functor.map(Data_Functor.functorArray)(escapeChar)(Data_String.split("")(s)));
};
var showAttrs = (function () {
    var showAttr = function (v) {
        return " " + (v.value0 + ("=\"" + ($$escape(v.value1) + "\"")));
    };
    return function ($15) {
        return Data_Foldable.fold(Data_CatList.foldableCatList)(Data_Monoid.monoidString)(Data_Functor.map(Data_CatList.functorCatList)(showAttr)($15));
    };
})();
var render = function (v) {
    if (v instanceof Text_Smolder_Markup.Element) {
        var c = render(v.value1);
        return "<" + (v.value0 + (showAttrs(v.value2) + ((function () {
            var $6 = Data_String.length(c) > 0;
            if ($6) {
                return ">" + (c + ("</" + (v.value0 + ">")));
            };
            return "/>";
        })() + render(v.value4))));
    };
    if (v instanceof Text_Smolder_Markup.Content) {
        return $$escape(v.value0) + render(v.value1);
    };
    if (v instanceof Text_Smolder_Markup.Return) {
        return "";
    };
    throw new Error("Failed pattern match at Text.Smolder.Renderer.String line 36, column 1 - line 41, column 32: " + [ v.constructor.name ]);
};
module.exports = {
    render: render
};
